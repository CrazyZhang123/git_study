
# einops.rearrange


是一个用户友好的多维张量智能元素重排工具。此操作包含了转置（轴排列）、重塑（视图）、挤压、扩展维度、堆叠、连接等多种操作的功能。

rearrange 操作的示例：

```python
 # 假设我们有一组 32 张 "h w c" 格式的图像（高度-宽度-通道）  
 >>> images = [np.random.randn(30, 40, 3) for _ in range(32)]  
 ​  
 # 沿第一个（批次）轴堆叠，输出是一个单一数组  
 >>> rearrange(images, 'b h w c -> b h w c').shape  
 (32, 30, 40, 3)  
 ​  
 # 沿高度（垂直轴）连接图像，960 = 32 * 30  
 >>> rearrange(images, 'b h w c -> (b h) w c').shape  
 (960, 40, 3)  
 ​  
 # 沿水平轴连接图像，1280 = 32 * 40  
 >>> rearrange(images, 'b h w c -> h (b w) c').shape  
 (30, 1280, 3)  
 ​  
 # 重新排列轴为 "b c h w" 格式用于深度学习  
 >>> rearrange(images, 'b h w c -> b c h w').shape  
 (32, 3, 30, 40)  
 ​  
 # 将每张图像展平为向量，3600 = 30 * 40 * 3  
 >>> rearrange(images, 'b h w c -> b (c h w)').shape  
 (32, 3600)  
 ​  
 # 将每张图像分割成 4 个更小的部分（左上、右上、左下、右下），128 = 32 * 2 * 2  
 >>> rearrange(images, 'b (h1 h) (w1 w) c -> (b h1 w1) h w c', h1=2, w1=2).shape  
 (128, 15, 20, 3)  
 ​  
 # space-to-depth 操作  
 >>> rearrange(images, 'b (h h1) (w w1) c -> b h w (c h1 w1)', h1=2, w1=2).shape  
 (32, 15, 20, 12)

```
在组合轴时，使用 C 顺序枚举（连续元素具有不同的最后一个轴）。更多示例请参见 einops 教程。