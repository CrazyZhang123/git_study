---
created: 2024-10-10T22:53
updated: 2025-01-29T21:47
---
## 1. main point
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20241010230510.png)
æˆ‘ä»¬å¸Œæœ›æ•™ä»€ä¹ˆï¼Ÿ
1. åº”ç”¨äºNLPçš„æœ‰æ•ˆç°ä»£æ·±åº¦å­¦ä¹ æ–¹æ³•çš„åŸºç¡€ã€‚
- é¦–å…ˆæ˜¯åŸºç¡€çŸ¥è¯†ï¼Œç„¶åæ˜¯NLPä¸­ä½¿ç”¨çš„å…³é”®æ–¹æ³•ï¼šå¾ªç¯ç½‘ç»œã€æ³¨æ„åŠ›ã€å˜æ¢å™¨ç­‰ã€‚
2. å¯¹äººç±»è¯­è¨€çš„æ€»ä½“ç†è§£ä»¥åŠç†è§£å’Œäº§ç”Ÿè¯­è¨€çš„å›°éš¾
3. å¯¹NLPä¸­ä¸€äº›ä¸»è¦é—®é¢˜çš„ç†è§£å’Œæ„å»ºç³»ç»Ÿçš„èƒ½åŠ›ï¼ˆåœ¨PyTorchä¸­ï¼‰ï¼š
- è¯ä¹‰ã€ä¾å­˜å…³ç³»è§£æã€æœºå™¨ç¿»è¯‘ã€é—®ç­”

example 
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20241101211602.png)
- ä¸¤ä¸ªå¥³äººåœ¨åµæ¶ï¼ŒåŒæ ·çš„è¯­è¨€ï¼Œä¸åŒäººçš„ç†è§£ä¸ä¸€æ ·
```ad-tip
è¿™ä¸ªæ¼«ç”»æ¥è‡ª _xkcd_ï¼Œè®¨è®ºäº†è¯­è¨€çš„æ··ä¹±æ€§å’Œäº¤æµçš„æœ¬è´¨ï¼Œå›´ç»•ç€ "I could care less"ï¼ˆæˆ‘å¯èƒ½æ›´ä¸åœ¨ä¹ï¼‰å’Œ "I couldn't care less"ï¼ˆæˆ‘ä¸€ç‚¹éƒ½ä¸åœ¨ä¹ï¼‰ä¹‹é—´çš„äº‰è®ºå±•å¼€ã€‚ä»¥ä¸‹æ˜¯å¯¹è¯ç¿»è¯‘å’Œè§£é‡Šï¼š
### **äººç‰©å¯¹è¯ï¼ˆæ±‰è‹±å¯¹ç…§ç‰ˆï¼‰**

#### **ç¬¬ä¸€éƒ¨åˆ†ï¼ˆè¯­æ³•çº æ­£äº‰è®º | Grammar Correction Debateï¼‰**

ğŸ‘©â€ğŸ¦°ï¼šã€Œâ€¦â€¦åæ­£ï¼Œæˆ‘å¯èƒ½æ›´ä¸åœ¨ä¹ã€‚ã€  
ğŸ‘©â€ğŸ¦°: "â€¦Anyway, I could care less."

ğŸ‘©ï¼šã€Œä½ æ˜¯æƒ³è¯´ â€˜I couldn't care lessâ€™ å§ï¼Ÿä½ è¿™æ ·è¯´ï¼ˆI could care lessï¼‰æ„å‘³ç€ä½ ä»ç„¶åœ¨ä¹ä¸€ç‚¹ã€‚ã€  
ğŸ‘©: "I think you mean you _couldnâ€™t_ care less. Saying _you could care less_ implies you care at least some amount."

ğŸ‘¦ï¼šã€Œå‘ƒâ€¦â€¦æˆ‘ä¸çŸ¥é“ã€‚ã€  
ğŸ‘¦: "I dunno."

---

#### **ç¬¬äºŒéƒ¨åˆ†ï¼ˆè¯­è¨€çš„æœ¬è´¨ | The Nature of Languageï¼‰**

ğŸ‘¦ï¼ˆç”»é¢è½¬é»‘æš—èƒŒæ™¯ï¼Œæ²‰æ€çŠ¶ï¼‰ï¼š  
ğŸ‘¦ (Floating in darkness, deep in thought):

ã€Œæˆ‘ä»¬è¿™äº›æåº¦å¤æ‚çš„å¤§è„‘åœ¨è™šç©ºä¸­æ¼‚æµ®ï¼Œå¾’åŠ³åœ°è¯•å›¾å½¼æ­¤è¿æ¥ï¼Œåªèƒ½ç›²ç›®åœ°å°†è¯è¯­æŠ›å‘é»‘æš—â€¦â€¦ã€  
_"We're these unbelievably complicated brains drifting through a void, trying in vain to connect with one another by blindly flinging words out into the darknessâ€¦"_

ã€Œæ¯ä¸€ä¸ªæªè¾ã€æ‹¼å†™ã€æ—¶é—´ç‚¹ã€è¯­è°ƒéƒ½æ‰¿è½½ç€æ— æ•°çš„ä¿¡å·ã€è¯­å¢ƒã€æ½œå°è¯ç­‰ç­‰â€¦â€¦  
è€Œæ¯ä¸ªå¬è€…éƒ½ä¼šä»¥è‡ªå·±çš„æ–¹å¼è§£è¯»è¿™äº›ä¿¡å·ã€‚ã€  
_"Every choice of phrasing and spelling and tone and timing carries countless signals and contexts and subtexts and more, and every listener interprets those signals in their own way."_

ã€Œè¯­è¨€å¹¶ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„ç³»ç»Ÿï¼Œè¯­è¨€æ˜¯è¾‰ç…Œçš„æ··æ²Œã€‚ã€  
_"Language isnâ€™t a formal system. Language is glorious chaos."_

---

#### **ç¬¬ä¸‰éƒ¨åˆ†ï¼ˆæ²Ÿé€šçš„æ„ä¹‰ | The Purpose of Communicationï¼‰**

ğŸ‘©ï¼šã€Œä½ æ°¸è¿œæ— æ³•ç¡®å®šä»»ä½•è¯å¯¹ä»»ä½•äººæ„å‘³ç€ä»€ä¹ˆã€‚ã€  
ğŸ‘©: "You can never know for sure what _any_ words will mean to _anyone_."

ã€Œä½ æ‰€èƒ½åšçš„ï¼Œå°±æ˜¯åŠªåŠ›å»çŒœæµ‹ä½ çš„è¯è¯­ä¼šå¦‚ä½•å½±å“ä»–äººï¼Œ  
è¿™æ ·ä½ æ‰æœ‰å¯èƒ½æ‰¾åˆ°é‚£äº›èƒ½è®©å¯¹æ–¹æ„Ÿå—åˆ°ä¸ä½ æƒ³è¡¨è¾¾çš„æƒ…æ„Ÿç›¸è¿‘çš„è¯ã€‚ã€  
_"All you can do is try to get better at guessing how your words affect people, so you can have a chance of finding the ones that will make them feel something like what you want them to feel."_

ã€Œé™¤æ­¤ä¹‹å¤–ï¼Œä¸€åˆ‡éƒ½æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚ã€  
_"Everything else is pointless."_

---

#### **ç¬¬å››éƒ¨åˆ†ï¼ˆå¯¹æ–¹çš„å›åº” | The Responseï¼‰**

ğŸ‘¦ï¼šã€Œæ‰€ä»¥ï¼Œä½ æ˜¯åœ¨å‘Šè¯‰æˆ‘ä½ å¦‚ä½•ç†è§£è¿™äº›è¯ï¼Œæ˜¯å› ä¸ºä½ å¸Œæœ›è®©æˆ‘æ„Ÿè§‰ä¸é‚£ä¹ˆå­¤å•ï¼Ÿ  
å¦‚æœæ˜¯çš„è¯ï¼Œè°¢è°¢ä½ ï¼Œé‚£å¯¹æˆ‘æ¥è¯´å¾ˆé‡è¦ã€‚ã€  
ğŸ‘¦: "I assume youâ€™re giving me tips on how you interpret words because you want me to feel less alone.  
If so, then thank you. That means a lot."

ğŸ‘¦ï¼šã€Œä½†å¦‚æœä½ åªæ˜¯å•çº¯åœ°åœ¨æˆ‘çš„å¥å­ä¸Šæ‰“ä¸ªå‹¾ï¼Œ  
ç„¶åç”¨å®ƒæ¥ç‚«è€€è‡ªå·±å¤šæ‡‚è¯­æ³•â€¦â€¦ã€  
ğŸ‘¦: "But if youâ€™re just running my sentences past some mental checklist so you can show off how well you know itâ€¦"

ğŸ‘¦ï¼ˆå¾®ç¬‘ï¼Œå¸¦æœ‰è®½åˆºæ„å‘³ï¼‰ï¼šã€Œé‚£æˆ‘å°±çœŸçš„å¯èƒ½æ›´ä¸åœ¨ä¹äº†ã€‚ã€  
ğŸ‘¦ (Smiling, sarcastically): "Then I _could_ care less."

### **è§£é‡Š**

è¿™ä¸ªæ¼«ç”»è®½åˆºäº†ä¸€ç§å¸¸è§çš„è¯­è¨€äº‰è®ºâ€”â€”çº æ­£åˆ«äººè¯´ "I could care less" è€Œé "I couldn't care less"ã€‚  
ä½†ä½œè€… _Randall Munroe_ é€šè¿‡æ¼«ç”»ä¸­çš„è§’è‰²è¡¨è¾¾äº†æ›´æ·±å±‚çš„è§‚ç‚¹ï¼š**è¯­è¨€ä¸æ˜¯å›ºå®šçš„é€»è¾‘ç³»ç»Ÿï¼Œè€Œæ˜¯æ··ä¹±ä½†ç¾ä¸½çš„äº¤æµå·¥å…·ã€‚**

- è¯­è¨€çš„æ„ä¹‰å–å†³äºå¬ä¼—å¦‚ä½•è§£è¯»ï¼Œè€Œä¸æ˜¯çº¯ç²¹çš„è¯­æ³•è§„åˆ™ã€‚
- çº æ­£åˆ«äººç”¨è¯çš„çœŸæ­£ç›®çš„åº”è¯¥æ˜¯å¸®åŠ©æ²Ÿé€šï¼Œè€Œä¸æ˜¯ç‚«è€€è‡ªå·±çš„çŸ¥è¯†ã€‚
- å¦‚æœåªæ˜¯çº æ­£è€Œæ²¡æœ‰å…³å¿ƒå¯¹æ–¹çš„æ„Ÿå—ï¼Œé‚£è¿™ç§çº æ­£å°±æ¯«æ— æ„ä¹‰ã€‚

æœ€åä¸€å¥ _"Then I could care less."_ è®½åˆºåœ°å›å‡»äº†æœ€åˆçš„çº æ­£è€…ï¼Œå¼ºè°ƒå¦‚æœåªæ˜¯ä¸ºäº†ç‚«è€€çŸ¥è¯†ï¼Œé‚£ä»–å°±çœŸçš„"ä¸åœ¨ä¹"äº†ã€‚
```

- äººç±»çš„æ²Ÿé€šèƒ½åŠ›ä½¿å¾—äººç±»æ¯”å…¶ä»–ç”Ÿç‰©æ›´æœ‰ä¼˜åŠ¿ã€‚

- è®¡ç®—æœºå’Œäººå·¥æ™ºèƒ½çš„å…³é”®é—®é¢˜ï¼š==å¦‚ä½•è®©è®¡ç®—æœºèƒ½å¤Ÿç†è§£äººç±»ä¼ è¾¾çš„æ„æ€==

## 2.æœºå™¨ç¿»è¯‘å’Œè‡ªç„¶è¯­è¨€å¤„ç†
### (1)æœºå™¨ç¿»è¯‘ neural machine translation
- Trained on text data, neural machine translation is quite good!
### (2)NLP è‡ªç„¶è¯­è¨€å¤„ç†
NLPçš„æœ€å¤§è¿›å±•æ˜¯GPT3
- GPT3: A first step on the path to universal models é€šç”¨æ¨¡å‹çš„ç¬¬ä¸€æ­¥
- æˆ‘ä»¬ä¸ç”¨å†å»ä¸“é—¨çš„è®¾å®šå…·ä½“çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ£€æµ‹åƒåœ¾é‚®ä»¶ï¼Œè‰²æƒ…ä¿¡æ¯ï¼Œä»»ä½•è¯­è¨€çš„ä¿¡æ¯ï¼Œåªæ˜¯å»ºç«‹æ‰€æœ‰è¿™äº›ä¸åŒä»»åŠ¡çš„ç‹¬ç«‹ç›‘ç£åˆ†ç±»å™¨,æˆ‘ä»¬åˆšåˆšå»ºç«‹äº†ä¸€ä¸ªå¯ä»¥ç†è§£çš„æ¨¡å‹ã€‚
==and just building all these separate supervised
classifiers for every different taskï¼Œwe've now just built up a  model  that  understands .

==æ‰€ä»¥å®ƒæ‰€èƒ½åšçš„åªæ˜¯é¢„æµ‹åé¢çš„å•è¯,å·¦è¾¹è¾“å…¥è¦ç”Ÿæˆä»€ä¹ˆï¼Œæ¨¡å‹å°±ä¼šç”Ÿæˆåé¢çš„æ–‡æœ¬ï¼Œå®é™…ä¸Šæ˜¯ä¸€æ¬¡é¢„æµ‹ä¸€ä¸ªå•è¯ï¼Œç„¶åç”Ÿæˆçš„å•è¯åˆä½œä¸ºè¾“å…¥å»é¢„æµ‹ï¼Œå¾ªç¯å¾€å¤ã€‚
So exactly what it does is it just predicts following words.

#### <1>GPT3 åŠŸèƒ½
- æˆ‘ä»¬ç»™å‡ºé—®é¢˜ï¼Œå’Œpromptï¼ŒGPT3å¯ä»¥ç»™å‡ºåˆç†çš„é—®ç­”åç»­
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20241101214712.png)
>    S: I broke the window.  
	Sï¼šæˆ‘æ‰“ç ´äº†çª—æˆ·ã€‚
	Q: What did I break?  
	Qï¼šæˆ‘æ‰“ç ´äº†ä»€ä¹ˆï¼Ÿ
	S: I gracefully saved the day.  
	Sï¼šæˆ‘ä¼˜é›…åœ°æ‹¯æ•‘äº†è¿™ä¸€å¤©ã€‚
	Q: What did I gracefully save?  
	Qï¼šæˆ‘ä¼˜é›…åœ°æ‹¯æ•‘äº†ä»€ä¹ˆï¼Ÿ
- ç¿»è¯‘sql
GPT3å¯ä»¥ç†è§£è¯­ä¹‰å’ŒSQLï¼Œè¿›è¡Œè½¬åŒ–
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20241101222157.png)

#### <2>å•è¯æ„ä¹‰çš„ç†è§£ the meaning of word
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20241101222333.png)
**Webster dictionaryå¯¹meaningçš„å®šä¹‰:** 
> é›†ä¸­åœ¨idea(æƒ³æ³•)è¿™é‡Œ
- the idea that is represented by a word, phrase, etc.
- the idea that a person wants to express by using words, signs, etc.
- the idea that is expressed in a work of writing, art, etc.
**Commonest linguistic way of thinking of meaning:**
æœ€å¸¸è§çš„è¯­è¨€æ„ä¹‰æ€ç»´æ–¹å¼ï¼š
ç¬¦å·(symbol) å’Œ æƒ³æ³•æˆ–è€…äº‹æƒ…(idea or thing) çš„å¯¹åº”(pair) ç›¸å½“äº denotational semantics æŒ‡ç§°è¯­ä¹‰

### (3)è®¡ç®—æœºä¸­çš„æœ‰ç”¨æ„ä¹‰ usable meaning in computer 
How do we have usable meaning in a computer?
æˆ‘ä»¬å¦‚ä½•åœ¨è®¡ç®—æœºä¸­æ‹¥æœ‰æœ‰ç”¨çš„æ„ä¹‰ï¼Ÿ

ä¼ ç»Ÿæ„ä¹‰ä¸Šåœ¨NLPä¸­ä½¿ç”¨meaning,æ˜¯å……åˆ†ä½¿ç”¨è¯å…¸(dictionary),ç‰¹åˆ«æ˜¯è¯åº“ï¼Œæ¯”å¦‚æµè¡Œçš„**WordNet**,å®ƒç»„ç»‡äº†word and terms(å•è¯å’Œæœ¯è¯­)åˆ†ä¸ºä¸¤ä¸ªsetï¼Œä¸€ä¸ªæ˜¯åŒä¹‰è¯é›†åˆ(synonym sets)å¦ä¸€ä¸ªæ˜¯(hypernyms)

**Common NLP solution:**
Use, e.g., WordNet, a thesaurus(åˆ†ç±»è¯å…¸) containing lists of synonym sets and hypernyms ("is a"relationships).
å¸¸è§çš„NLPè§£å†³æ–¹æ¡ˆï¼šä¾‹å¦‚ï¼Œä½¿ç”¨WordNetï¼Œä¸€ä¸ªåŒ…å«åŒä¹‰è¯é›†å’Œè¶…ä¹‰è¯åˆ—è¡¨ï¼ˆâ€œis aâ€å…³ç³»ï¼‰çš„åŒä¹‰è¯è¯å…¸ã€‚

![image.png|613](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129141117.png)

### (4)WordNetç­‰èµ„æºçš„é—®é¢˜ Problems with resources like WordNet 
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129142422.png)

- ä½œä¸ºä¸€ç§èµ„æºå¾ˆæ£’ï¼Œä½†ç¼ºå°‘ç»†å¾®å·®åˆ«
	- ä¾‹å¦‚ï¼Œâ€œproficient(ç²¾é€š)â€è¢«åˆ—ä¸ºâ€œgood(è‰¯å¥½)â€çš„åŒä¹‰è¯,è¿™ä»…åœ¨æŸäº›æƒ…å†µä¸‹æ˜¯æ­£ç¡®çš„
-   ç¼ºå°‘å•è¯çš„æ–°å«ä¹‰
	- ä¾‹å¦‚ï¼Œé‚ªæ¶çš„ã€åè›‹çš„ã€æ¼‚äº®çš„ã€å·«å¸ˆçš„ã€å¤©æ‰çš„ã€å¿è€…çš„ã€æœ€æ£’çš„ã€‚(wicked, badass, nifty, wizard, genius, ninja, bombest)
	- æ— æ³•ä¿æŒæœ€æ–°çŠ¶æ€(up-to-date)ï¼
- ä¸»è§‚çš„(subjective)
- éœ€è¦äººç±»åŠ³åŠ¨æ¥åˆ›é€ å’Œé€‚åº”ã€‚
- æ— æ³•è®¡ç®—å‡†ç¡®çš„å•è¯ç›¸ä¼¼åº¦

### (5)ç¦»æ•£ç¬¦å·çš„å•è¯ words as discrete symbols 
Representing words as discrete symbols
å°†å•è¯è¡¨ç¤ºä¸ºç¦»æ•£ç¬¦å·

ln traditional NLP, we regard words as discrete symbols:hotel, conference, motel- a localist representation
åœ¨ä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œ**æˆ‘ä»¬å°†è¯è¯­è§†ä¸ºç¦»æ•£çš„ç¬¦å·**ï¼šæ—…é¦†ã€ä¼šè®®ã€æ±½è½¦æ—…é¦†--â€œa localist representationï¼ˆå±€éƒ¨è¡¨å¾ï¼‰in deep learning

> åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œ**localist representation**ï¼ˆå±€éƒ¨è¡¨ç¤ºï¼‰æŒ‡çš„æ˜¯å°†æ¯ä¸ªæ¦‚å¿µã€ç±»åˆ«æˆ–ç‰¹å®šç‰¹å¾ç”±å•ä¸ªç¥ç»å…ƒæˆ–æå°‘é‡ç¥ç»å…ƒç‹¬ç«‹è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç¥ç»ç½‘ç»œä¸­ï¼ŒæŸä¸ªç‰¹å®šçš„ç¥ç»å…ƒå¯èƒ½ä¸“é—¨å¯¹â€œçŒ«â€è¿™ä¸€æ¦‚å¿µè´Ÿè´£ï¼Œè€Œå¦ä¸€ä¸ªç¥ç»å…ƒå¯èƒ½ä»£è¡¨â€œç‹—â€ã€‚
> ç›¸æ¯”ä¹‹ä¸‹ï¼Œ**distributed representation**ï¼ˆåˆ†å¸ƒå¼è¡¨ç¤ºï¼‰æ˜¯æ›´å¸¸è§çš„åšæ³•ï¼Œå®ƒå°†ä¿¡æ¯ç¼–ç ä¸ºå¤šä¸ªç¥ç»å…ƒçš„æ¿€æ´»æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨Transformeræ¨¡å‹ä¸­ï¼Œä¸€ä¸ªè¯çš„å«ä¹‰å¯èƒ½ç”±å¤šä¸ªéšè—å•å…ƒçš„ç»„åˆå†³å®šï¼Œè€Œä¸æ˜¯å•ç‹¬çš„ç¥ç»å…ƒã€‚
> **å±€éƒ¨è¡¨ç¤ºçš„ä¼˜ç‚¹æ˜¯å¯è§£é‡Šæ€§æ›´å¼ºï¼Œä½†ç¼ºç‚¹æ˜¯å®¹æ˜“å¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸è¶³ï¼ˆgeneralization issueï¼‰ï¼Œå› ä¸ºå®ƒç¼ºä¹å¯¹æ•°æ®çš„å¹¿æ³›ç‰¹å¾æå–èƒ½åŠ›ã€‚**

å¯ä»¥ä½¿ç”¨ one-hot vectors ä¹Ÿå°±æ˜¯ç‹¬çƒ­ç¼–ç è¿›è¡Œè¡¨ç¤ºï¼Œç»´åº¦æ˜¯è¯è¡¨çš„é•¿åº¦ã€‚
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129143851.png)

å½“æƒ³è¦æœ Seattle motel ï¼Œæƒ³å»åŒ¹é… Seattle hotelï¼Œä½†motelå’Œhotelçš„ç‹¬çƒ­ç¼–ç 
- "These two vectors are orthogonal" â†’ è¿™ä¸¤ä¸ªå‘é‡æ˜¯**æ­£äº¤çš„**
- "There is no natural notion of similarity for one-hot vectors!" â†’ **ç‹¬çƒ­ï¼ˆone-hotï¼‰å‘é‡**æœ¬èº«æ²¡æœ‰è‡ªç„¶çš„**ç›¸ä¼¼æ€§**æ¦‚å¿µï¼
- **Solution:** â†’ **è§£å†³æ–¹æ¡ˆï¼š**
    - "Could try to rely on WordNetâ€™s list of synonyms to get similarity?" â†’ **å¯ä»¥å°è¯•ä¾èµ– WordNet çš„åŒä¹‰è¯åˆ—è¡¨æ¥è·å¾—ç›¸ä¼¼æ€§ï¼Ÿ**
        - "But it is well-known to fail badly: incompleteness, etc." â†’ **ä½†è¿™æ–¹æ³•ä¼—æ‰€å‘¨çŸ¥æ•ˆæœå¾ˆå·®ï¼Œæ¯”å¦‚ä¸å®Œæ•´æ€§ç­‰é—®é¢˜ã€‚**
    - "**Instead: learn to encode similarity in the vectors themselves**" â†’ **ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥è®©å‘é‡æœ¬èº«å­¦ä¹ ç¼–ç ç›¸ä¼¼æ€§ã€‚**
æ›´å¥½çš„æ–¹æ³•æ˜¯**è®©æ¨¡å‹å­¦ä¹ å¦‚ä½•åœ¨å‘é‡ä¸­ç¼–ç ç›¸ä¼¼æ€§**ï¼Œè¿™ä¹Ÿæ˜¯**è¯å‘é‡ï¼ˆword embeddingsï¼‰** æ–¹æ³• ï¼ˆå¦‚ Word2Vecã€GloVeã€BERTï¼‰çš„æ ¸å¿ƒæ€æƒ³ã€‚è¿™äº›æ–¹æ³•èƒ½å°†è¯­ä¹‰ä¸Šç›¸ä¼¼çš„è¯æ˜ å°„åˆ°ç›¸è¿‘çš„å‘é‡ç©ºé—´ï¼Œä»è€Œæä¾›æ›´åˆç†çš„ç›¸ä¼¼æ€§åº¦é‡ã€‚
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129144104.png)

### (6)å•è¯åˆ†å¸ƒå¼è¡¨ç¤º word distributed representation 

ç”¨ä¸Šä¸‹æ–‡è¡¨ç¤ºå•è¯ Representing words by their context
â†’ **ç”¨ä¸Šä¸‹æ–‡è¡¨ç¤ºå•è¯**
![image.png|603](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129145003.png)

**Translation:**
- **Distributional semantics: A wordâ€™s meaning is given by the words that frequently appear close-by** â†’ **åˆ†å¸ƒå¼è¯­ä¹‰ï¼šä¸€ä¸ªå•è¯çš„å«ä¹‰ç”±å…¶é™„è¿‘é¢‘ç¹å‡ºç°çš„å•è¯å†³å®šã€‚**
    - _â€œYou shall know a word by the company it keepsâ€_ (J. R. Firth 1957: 11) â†’ **â€œä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªå•è¯çš„ä¼´éšè¯æ¥äº†è§£å®ƒçš„å«ä¹‰ã€‚â€**ï¼ˆJ. R. Firth 1957ï¼‰
    - **<mark style="background: FFFF00;">One of the most successful ideas of modern statistical NLP! â†’ ç°ä»£ç»Ÿè®¡è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æœ€æˆåŠŸçš„æ€æƒ³ä¹‹ä¸€ï¼ </mark>**
- **When a word _w_ appears in a text, its context is the set of words that appear nearby (within a fixed-size window).**  
    â†’ **å½“ä¸€ä¸ªå•è¯ _w_ å‡ºç°åœ¨æ–‡æœ¬ä¸­æ—¶ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰æ˜¯å…¶é™„è¿‘ï¼ˆåœ¨ä¸€ä¸ªå›ºå®šå¤§å°çš„çª—å£å†…ï¼‰å‡ºç°çš„å•è¯é›†åˆã€‚**
- **Use the many contexts of _w_ to build up a representation of _w_**  
    â†’ **åˆ©ç”¨ _w_ çš„å¤šä¸ªä¸Šä¸‹æ–‡æ¥æ„å»º _w_ çš„è¡¨ç¤ºã€‚**
- **These context words will represent banking**  
    â†’ **è¿™äº›ä¸Šä¸‹æ–‡å•è¯å°†ç”¨äºè¡¨ç¤º â€œbankingâ€ã€‚**
è¿™å¼ å¹»ç¯ç‰‡ä»‹ç»äº†**åˆ†å¸ƒå¼è¯­ä¹‰ï¼ˆdistributional semantics)çš„æ ¸å¿ƒæ€æƒ³ï¼Œå³**â€œä¸€ä¸ªå•è¯çš„æ„ä¹‰ç”±å…¶ä¸Šä¸‹æ–‡å†³å®šâ€**ã€‚è¿™ä¸€ç†å¿µç”±è¯­è¨€å­¦å®¶ J. R. Firth æå‡ºï¼Œè¢«å¹¿æ³›åº”ç”¨äºç°ä»£è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ï¼Œç‰¹åˆ«æ˜¯åœ¨**è¯å‘é‡ï¼ˆword embeddingsï¼‰**çš„è®­ç»ƒä¸­ï¼ˆå¦‚ Word2Vecã€GloVe ç­‰ï¼‰ã€‚

ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨å¤šä¸ªå¥å­ä¸­ï¼Œ**banking** ä¸€è¯çš„ä¸Šä¸‹æ–‡å¯èƒ½åŒ…æ‹¬ **crisesï¼ˆå±æœºï¼‰ã€regulationï¼ˆç›‘ç®¡ï¼‰ã€systemï¼ˆç³»ç»Ÿï¼‰** ç­‰ã€‚è¿™äº›ä¸Šä¸‹æ–‡å•è¯å¯ä»¥ç”¨æ¥å­¦ä¹  **banking** çš„å«ä¹‰ï¼Œä»è€Œåœ¨å‘é‡ç©ºé—´ä¸­å½¢æˆ**è¯­ä¹‰ç›¸ä¼¼æ€§**ï¼ˆsemantic similarityï¼‰ã€‚è¿™ç§æ–¹æ³•æ¯”ä¼ ç»Ÿçš„**one-hotç¼–ç **æ›´å…·è¡¨è¾¾èƒ½åŠ›ï¼Œå› ä¸ºå®ƒèƒ½æ•æ‰å•è¯ä¹‹é—´çš„**è¯­ä¹‰å…³ç³»**ã€‚

what we want to do is based on looking at the words that occur in context as vectors that we want to build up dense real valued vector for each word, that in some sense represents the meaning of that word and the way it will represent the meaning of that word is that this vector will be useful for predicting other words that occur in the context.
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åŸºäº**ä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„å•è¯**ï¼Œå°†å®ƒä»¬è¡¨ç¤ºä¸ºå‘é‡ï¼Œå¹¶æ„å»º**ç¨ å¯†çš„å®å€¼å‘é‡**ï¼Œä½¿æ¯ä¸ªå•è¯çš„å‘é‡åœ¨æŸç§ç¨‹åº¦ä¸Šèƒ½å¤Ÿè¡¨ç¤ºè¯¥å•è¯çš„**æ„ä¹‰**ã€‚è€Œè¿™ç§å‘é‡è¡¨ç¤ºå•è¯æ„ä¹‰çš„æ–¹å¼æ˜¯ï¼Œä½¿è¯¥å‘é‡åœ¨é¢„æµ‹**ä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„å…¶ä»–å•è¯**æ—¶å…·æœ‰**å®é™…çš„ä½œç”¨**ã€‚

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129150507.png)
**Translation:**

- **Word vectors** â†’ **è¯å‘é‡**
- **We will build a dense vector for each word, chosen so that it is similar to vectors of words that appear in similar contexts**  
    â†’ **æˆ‘ä»¬å°†ä¸ºæ¯ä¸ªå•è¯æ„å»ºä¸€ä¸ªç¨ å¯†å‘é‡ï¼Œä½¿å…¶ä¸å‡ºç°åœ¨ç›¸ä¼¼ä¸Šä¸‹æ–‡ä¸­çš„å•è¯çš„å‘é‡ç›¸ä¼¼ã€‚**
- **banking =**  
    â†’ **banking çš„å‘é‡è¡¨ç¤ºå¦‚ä¸‹ï¼š** $$\begin{bmatrix} 0.286 \\ 0.792 \\ -0.177 \\ -0.107 \\ 0.109 \\ -0.542 \\ 0.349 \\ 0.271 \end{bmatrix}â€‹
$$
- **Note: word vectors are also called word embeddings or (neural) word representations**  
    â†’ **æ³¨æ„ï¼šè¯å‘é‡ï¼ˆword vectorsï¼‰ä¹Ÿè¢«ç§°ä¸º** **è¯åµŒå…¥ï¼ˆword embeddingsï¼‰** æˆ– **ï¼ˆç¥ç»ç½‘ç»œï¼‰è¯è¡¨ç¤ºï¼ˆneural word representationsï¼‰ã€‚**
- **They are a distributed representation**  
    â†’ å®ƒä»¬æ˜¯ä¸€ç§ åˆ†å¸ƒå¼è¡¨ç¤ºï¼ˆdistributed representationï¼‰ã€‚

è¿™å¼ å¹»ç¯ç‰‡ä»‹ç»äº†**è¯å‘é‡ï¼ˆword vectorsï¼‰**çš„æ¦‚å¿µã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œæˆ‘ä»¬ä¸å†ä½¿ç”¨**one-hotç¼–ç **ï¼ˆç‹¬çƒ­ç¼–ç ï¼‰æ¥è¡¨ç¤ºå•è¯ï¼Œè€Œæ˜¯ç”¨**å¯†é›†å‘é‡ï¼ˆdense vectorsï¼‰**ï¼Œå…¶ä¸­æ¯ä¸ªå•è¯éƒ½ä¼šè¢«æ˜ å°„åˆ°ä¸€ä¸ªå¤šç»´ç©ºé—´ä¸­çš„ç‚¹ã€‚

è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
- **è¯­ä¹‰ç›¸ä¼¼çš„å•è¯**åœ¨å‘é‡ç©ºé—´ä¸­**è·ç¦»è¾ƒè¿‘**ã€‚
- è¿™äº›å‘é‡æ˜¯é€šè¿‡**ä¸Šä¸‹æ–‡ä¿¡æ¯**è®­ç»ƒå¾—åˆ°çš„ï¼Œå› æ­¤èƒ½æ•æ‰å•è¯çš„**è¯­ä¹‰ä¿¡æ¯**ã€‚
- **åˆ†å¸ƒå¼è¡¨ç¤ºï¼ˆdistributed representationï¼‰**æ„å‘³ç€å•è¯çš„å«ä¹‰ç”±å‘é‡çš„å¤šä¸ªç»´åº¦å…±åŒç¼–ç ï¼Œè€Œä¸æ˜¯ç”±æŸä¸€ä¸ªç‰¹å®šçš„ç»´åº¦å†³å®šã€‚

ä¾‹å¦‚ï¼Œåœ¨ Word2Vecã€GloVe æˆ– BERT è¿™æ ·çš„è¯å‘é‡æ¨¡å‹ä¸­ï¼Œ**banking** çš„å‘é‡è¡¨ç¤ºå¯èƒ½æ¥è¿‘ **financeï¼ˆé‡‘èï¼‰ã€investmentï¼ˆæŠ•èµ„ï¼‰** è¿™æ ·çš„è¯ï¼Œè€Œè¿œç¦» **appleï¼ˆè‹¹æœï¼‰æˆ– tableï¼ˆæ¡Œå­ï¼‰**ã€‚
![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129151351.png)

## 3ã€å¼•å…¥Word2vec:Overview æ ¸å¿ƒæ€æƒ³

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129151221.png)
**Translation:**
```ad-tip
**Word2vec** (Mikolov et al. 2013) is a framework for learning word vectors  
â†’ **Word2vec**ï¼ˆMikolov ç­‰ï¼Œ2013ï¼‰æ˜¯ä¸€ä¸ªç”¨äºå­¦ä¹ è¯å‘é‡çš„æ¡†æ¶
#### **Ideaï¼ˆæ ¸å¿ƒæ€æƒ³ï¼‰ï¼š**

- **We have a large corpus ("body") of text**  
    â†’ **æˆ‘ä»¬æœ‰ä¸€ä¸ªåºå¤§çš„è¯­æ–™åº“ï¼ˆæ–‡æœ¬é›†åˆï¼‰**
- **Every word in a fixed vocabulary is represented by a vector**  
    â†’ **å›ºå®šè¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªå•è¯éƒ½ç”¨ä¸€ä¸ªå‘é‡è¡¨ç¤º**
- **Go through each position _t_ in the text, which has a center word _c_ and context ("outside") words _o_**  
    â†’ **éå†æ–‡æœ¬ä¸­çš„æ¯ä¸ªä½ç½® _t_ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªä¸­å¿ƒè¯ _c_ å’Œä¸Šä¸‹æ–‡ï¼ˆâ€œå¤–éƒ¨â€ï¼‰å•è¯ _o_**
- **Use the similarity of the word vectors for _c_ and _o_ to calculate the probability of _o_ given _c_ (or vice versa)**  
    â†’ **åˆ©ç”¨ _c_ å’Œ _o_ çš„è¯å‘é‡ç›¸ä¼¼æ€§æ¥è®¡ç®—åœ¨ç»™å®š _c_ï¼ˆæˆ–åä¹‹ï¼‰æƒ…å†µä¸‹å‡ºç° _o_ çš„æ¦‚ç‡**
- <mark style="background: FFFF00;">Keep adjusting the word vectors to maximize this probability
    â†’ ä¸æ–­è°ƒæ•´è¯å‘é‡ï¼Œä½¿è¯¥æ¦‚ç‡æœ€å¤§åŒ–</mark>
```
 

**Explanation:**  
è¿™å¼ å¹»ç¯ç‰‡ä»‹ç»äº† **Word2Vec** çš„åŸºæœ¬æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ª**ç”¨äºå­¦ä¹ è¯å‘é‡çš„æ— ç›‘ç£ç®—æ³•**ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š

1. **CBOWï¼ˆContinuous Bag of Wordsï¼‰**ï¼šæ ¹æ®**ä¸Šä¸‹æ–‡**é¢„æµ‹**ä¸­å¿ƒè¯**ã€‚
2. **Skip-gram**ï¼šæ ¹æ®**ä¸­å¿ƒè¯**é¢„æµ‹**ä¸Šä¸‹æ–‡å•è¯**ã€‚

Word2Vec çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œ**é€šè¿‡ä¸Šä¸‹æ–‡å­¦ä¹ å•è¯çš„å‘é‡è¡¨ç¤º**ï¼Œä½¿å¾—è¯­ä¹‰ç›¸ä¼¼çš„å•è¯åœ¨å‘é‡ç©ºé—´ä¸­å½¼æ­¤é è¿‘ã€‚ä¾‹å¦‚ï¼Œåœ¨è®­ç»ƒåï¼Œ**king - man + woman â‰ˆ queen**ï¼Œè¿™è¡¨æ˜ Word2Vec å¯ä»¥å­¦ä¹ åˆ°å•è¯ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ã€‚

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129152356.png)

### (1)ç›®æ ‡å‡½æ•° Word2vec: objective function 

the big question is ,what are we doing for working out the probability of a word occurring in the context of the center word?
**å…³é”®é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•è®¡ç®—ä¸€ä¸ªå•è¯åœ¨ä¸­å¿ƒè¯ä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„æ¦‚ç‡ï¼Ÿ**

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129152904.png)

**æ ‡é¢˜**ï¼šWord2vecï¼šç›®æ ‡å‡½æ•°
**æ­£æ–‡**ï¼šå¯¹äºæ¯ä¸ªä½ç½®$t = 1, \ldots, T$ï¼Œåœ¨ç»™å®šä¸­å¿ƒè¯$w_t$çš„æƒ…å†µä¸‹ï¼Œåœ¨å›ºå®šå¤§å°ä¸º$m$çš„çª—å£å†…é¢„æµ‹ä¸Šä¸‹æ–‡è¯ã€‚
æ•°æ®ä¼¼ç„¶æ€§ï¼š$$ Likelihood =L(\theta)=\prod_{t = 1}^{T}\prod_{\substack{-m\leq j\leq m\\j\neq0}}P(w_{t + j}|w_t;\theta)$$ $\theta$æ˜¯æ‰€æœ‰è¦ä¼˜åŒ–çš„å˜é‡ã€‚ 
ç›®æ ‡å‡½æ•°(**æœ‰æ—¶è¢«ç§°ä¸ºä»£ä»·å‡½æ•°æˆ–æŸå¤±å‡½æ•°**)$J(\theta)$æ˜¯ï¼ˆå¹³å‡ï¼‰è´Ÿå¯¹æ•°ä¼¼ç„¶æ€§ï¼š $$J(\theta)=-\frac{1}{T}\log L(\theta)=-\frac{1}{T}\sum_{t = 1}^{T}\sum_{\substack{-m\leq j\leq m\\j\neq0}}\log P(w_{t + j}|w_t;\theta)$$ æœ€å°åŒ–ç›®æ ‡å‡½æ•°$\Leftrightarrow$æœ€å¤§åŒ–é¢„æµ‹å‡†ç¡®æ€§ã€‚ 

åœ¨Word2vecä¸­ï¼Œä¸Šè¿°ç›®æ ‡å‡½æ•°çš„è®¾è®¡ç›®çš„æ˜¯é€šè¿‡ç»™å®šä¸­å¿ƒè¯æ¥é¢„æµ‹å…¶ä¸Šä¸‹æ–‡è¯ï¼Œä»è€Œå­¦ä¹ åˆ°è¯çš„åˆ†å¸ƒå¼è¡¨ç¤ºã€‚
ä»¥ä¸‹æ˜¯å¯¹å…¶çš„è¯¦ç»†è§£é‡Šï¼š 
- **ä¼¼ç„¶æ€§å‡½æ•°**ï¼š$L(\theta)=\prod_{t = 1}^{T}\prod_{\substack{-m\leq j\leq m\\j\neq0}}P(w_{t + j}|w_t;\theta)$ **è¡¨ç¤ºåœ¨æ•´ä¸ªæ–‡æœ¬åºåˆ—ï¼ˆé•¿åº¦ä¸º$T$ï¼‰ä¸­ï¼Œå¯¹äºæ¯ä¸ªä½ç½®$t$çš„ä¸­å¿ƒè¯$w_t$ï¼Œåœ¨ä»¥å®ƒä¸ºä¸­å¿ƒçš„å¤§å°ä¸º$m$çš„çª—å£å†…ï¼Œé¢„æµ‹ä¸Šä¸‹æ–‡è¯çš„è”åˆæ¦‚ç‡**ã€‚è¿™é‡Œ$\theta$æ˜¯æ¨¡å‹ä¸­æ‰€æœ‰å¾…ä¼˜åŒ–çš„å‚æ•°ï¼Œæ¯”å¦‚è¯å‘é‡ç­‰ã€‚é€šè¿‡è¿™ä¸ªè¿ä¹˜å½¢å¼ï¼Œå°†æ‰€æœ‰ä½ç½®çš„é¢„æµ‹æ¦‚ç‡è”åˆèµ·æ¥ï¼Œè¡¡é‡æ¨¡å‹åœ¨æ•´ä¸ªæ–‡æœ¬ä¸Šå¯¹ä¸Šä¸‹æ–‡è¯é¢„æµ‹çš„å¯èƒ½æ€§å¤§å°ã€‚
- **ç›®æ ‡å‡½æ•°**ï¼š$J(\theta)=-\frac{1}{T}\log L(\theta)$ æ˜¯è´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°ã€‚å–å¯¹æ•°æ˜¯ä¸ºäº†å°†è¿ä¹˜è¿ç®—è½¬æ¢ä¸ºåŠ æ³•è¿ç®—ï¼Œæ–¹ä¾¿è®¡ç®—å’Œä¼˜åŒ–ï¼›**<mark style="background: #FF0000;">å‰é¢åŠ è´Ÿå·(ä¸€èˆ¬éƒ½æ˜¯æœ€å°åŒ–)æ˜¯å› ä¸ºé€šå¸¸ä¼˜åŒ–è¿‡ç¨‹æ˜¯æœ€å°åŒ–ç›®æ ‡å‡½æ•°ï¼Œè€Œä¼¼ç„¶æ€§æ˜¯å¸Œæœ›è¶Šå¤§è¶Šå¥½ï¼Œæ‰€ä»¥å–è´Ÿå¯¹æ•°åå˜æˆæœ€å°åŒ–é—®é¢˜ã€‚</mark>**$-\frac{1}{T}$æ˜¯å¯¹æ•´ä¸ªæ–‡æœ¬åºåˆ—æ±‚å¹³å‡ï¼Œä½¿å¾—ç›®æ ‡å‡½æ•°çš„å€¼æ›´å…·ä»£è¡¨æ€§å’Œç¨³å®šæ€§ã€‚æœ€å°åŒ–è¿™ä¸ªç›®æ ‡å‡½æ•°å°±æ„å‘³ç€è¦æœ€å¤§åŒ–æ¨¡å‹å¯¹äºä¸Šä¸‹æ–‡è¯çš„é¢„æµ‹å‡†ç¡®æ€§ï¼Œå³è®©æ¨¡å‹èƒ½å¤Ÿæ›´å‡†ç¡®åœ°æ ¹æ®ä¸­å¿ƒè¯é¢„æµ‹å‡ºå…¶å‘¨å›´çš„ä¸Šä¸‹æ–‡è¯ï¼Œä»è€Œä½¿å¾—å­¦ä¹ åˆ°çš„è¯å‘é‡èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰è¯ä¸è¯ä¹‹é—´çš„è¯­ä¹‰å…³ç³» ã€‚

![image.png|520](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129193538.png)
æ¦‚ç‡è®¡ç®—é—®é¢˜ 
- æ¥ç€æå‡ºé—®é¢˜â€œHow to calculate $P(w_{t + j}|w_t;\theta)$?â€ï¼Œå³å¦‚ä½•è®¡ç®—ç»™å®šä¸­å¿ƒè¯$w_t$æ—¶ä¸Šä¸‹æ–‡è¯$w_{t + j}$çš„æ¡ä»¶æ¦‚ç‡ã€‚ 
æ¦‚ç‡è®¡ç®—æ–¹æ³• 
 - ç­”æ¡ˆæ˜¯**å¯¹æ¯ä¸ªè¯$w$ä½¿ç”¨ä¸¤ä¸ªå‘é‡ï¼šå½“$w$æ˜¯ä¸­å¿ƒè¯æ—¶ç”¨$v_w$ï¼Œå½“$w$æ˜¯ä¸Šä¸‹æ–‡è¯æ—¶ç”¨$u_w$ã€‚** 
 - å¯¹äºä¸­å¿ƒè¯$c$å’Œä¸Šä¸‹æ–‡è¯$o$ï¼Œæ¡ä»¶æ¦‚ç‡$P(o|c)$çš„è®¡ç®—å…¬å¼ä¸º$P(o|c)=\frac{\exp(u_o^T v_c)}{\sum_{w\in V}\exp(u_w^T v_c)}$ ã€‚
	 - è¿™é‡Œ$u_o^T v_c$æ˜¯ä¸Šä¸‹æ–‡è¯$o$çš„å‘é‡$u_o$å’Œä¸­å¿ƒè¯$c$çš„å‘é‡$v_c$çš„å†…ç§¯ï¼Œç”¨æ¥è¡¨ç¤ºè¯ä¹‹é—´çš„ç›¸ä¼¼æ€§
	 - åˆ†æ¯$\sum_{w\in V}\exp(u_w^T v_c)$æ˜¯å¯¹è¯æ±‡è¡¨$V$ä¸­æ‰€æœ‰è¯çš„ç›¸å…³è®¡ç®—ç»“æœæ±‚å’Œï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°ç»™å®šä¸­å¿ƒè¯$c$æ—¶ä¸Šä¸‹æ–‡è¯$o$å‡ºç°çš„æ¦‚ç‡ï¼Œç”¨äºåç»­ç›®æ ‡å‡½æ•°çš„è®¡ç®—å’Œæ¨¡å‹ä¼˜åŒ–ã€‚

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129195318.png)

ä¸»è¦å›´ç»•Word2vecä¸­è®¡ç®—ä¸Šä¸‹æ–‡è¯æ¦‚ç‡æ—¶ä½¿ç”¨çš„softmaxå‡½æ•°å±•å¼€è§£é‡Šï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š
#### æ¡ä»¶æ¦‚ç‡å…¬å¼åˆ†æ 
- å¯¹äºæ¡ä»¶æ¦‚ç‡å…¬å¼$$P(o|c)=\frac{\exp(u_o^T v_c)}{\sum_{w\in V}\exp(u_w^T v_c)}$$
- â‘ å¤„æŒ‡å‡ºåˆ†å­ä¸­çš„ç‚¹ç§¯$u_o^T v_c$ï¼ˆ$u^T v = u \cdot v = \sum_{i = 1}^{n}u_i v_i$ ï¼‰ç”¨äºæ¯”è¾ƒä¸Šä¸‹æ–‡è¯$o$å’Œä¸­å¿ƒè¯$c$çš„ç›¸ä¼¼åº¦ã€‚**ç‚¹ç§¯è¶Šå¤§ï¼Œè¯´æ˜ä¸¤ä¸ªè¯çš„ç›¸ä¼¼åº¦è¶Šé«˜ï¼Œå¯¹åº”çš„æ¦‚ç‡ä¹Ÿå°±è¶Šå¤§ã€‚** 
- â‘¡å¤„è¡¨æ˜æŒ‡æ•°è¿ç®—$\exp$çš„ä½œç”¨æ˜¯**ä½¿ä»»ä½•å€¼å˜ä¸ºæ­£æ•°ã€‚** è¿™æ˜¯å› ä¸ºåœ¨æ¦‚ç‡è®¡ç®—ä¸­ï¼Œæ¦‚ç‡å€¼å¿…é¡»æ˜¯éè´Ÿçš„ï¼Œé€šè¿‡æŒ‡æ•°è¿ç®—æ»¡è¶³äº†è¿™ä¸€è¦æ±‚ã€‚ 
- â‘¢å¤„è¯´æ˜**åˆ†æ¯å¯¹è¯æ±‡è¡¨$V$ä¸­æ‰€æœ‰è¯è¿›è¡Œè®¡ç®—ï¼Œç›®çš„æ˜¯åœ¨æ•´ä¸ªè¯æ±‡è¡¨ä¸Šè¿›è¡Œå½’ä¸€åŒ–ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚** å³é€šè¿‡è¿™ç§æ–¹å¼ç¡®ä¿$P(o|c)$çš„ç»“æœæ˜¯ä¸€ä¸ªä»‹äº0å’Œ1ä¹‹é—´çš„å€¼ï¼Œä¸”æ‰€æœ‰å¯èƒ½çš„ä¸Šä¸‹æ–‡è¯çš„æ¦‚ç‡ä¹‹å’Œä¸º1ã€‚
#### softmaxå‡½æ•°ä»‹ç» 
- æŒ‡å‡ºä¸Šè¿°è®¡ç®—$P(o|c)$çš„è¿‡ç¨‹æ˜¯softmaxå‡½æ•°çš„ä¸€ä¸ªä¾‹å­ã€‚softmaxå‡½æ•°å°†$\mathbb{R}^n$ï¼ˆ$n$ç»´å®æ•°ç©ºé—´ï¼‰ä¸­çš„ä»»æ„å€¼$x_i$æ˜ å°„åˆ°$(0, 1)^n$ï¼ˆ$n$ç»´çš„å¼€åŒºé—´$(0, 1)$ï¼‰ä¸­çš„æ¦‚ç‡åˆ†å¸ƒ$p_i$ï¼Œå…¶è¡¨è¾¾å¼ä¸º$\text{softmax}(x_i)=\frac{\exp(x_i)}{\sum_{j = 1}^{n}\exp(x_j)} = p_i$ ã€‚
- å¯¹softmaxå‡½æ•°åç§°çš„è§£é‡Šï¼š 
	- â€œmaxâ€æ˜¯å› ä¸ºå®ƒä¼šæ”¾å¤§æœ€å¤§çš„$x_i$å¯¹åº”çš„æ¦‚ç‡ï¼Œä½¿å¾—åœ¨æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œè¾ƒå¤§çš„$x_i$å¯¹åº”çš„æ¦‚ç‡å€¼ç›¸å¯¹æ›´å¤§ã€‚ 
	- â€œsoftâ€æ˜¯å› ä¸ºå®ƒä»ç„¶ä¼šç»™è¾ƒå°çš„$x_i$åˆ†é…ä¸€å®šçš„æ¦‚ç‡ï¼Œè€Œä¸æ˜¯åƒç¡¬æœ€å¤§åŒ–ï¼ˆåªç»™æœ€å¤§å€¼åˆ†é…æ¦‚ç‡1ï¼Œå…¶ä»–ä¸º0ï¼‰é‚£æ ·ã€‚ 
	- **æœ€åæåˆ°softmaxå‡½æ•°åœ¨æ·±åº¦å­¦ä¹ ä¸­ç»å¸¸è¢«ä½¿ç”¨ï¼Œè™½ç„¶å®ƒçš„åå­—æœ‰ç‚¹å¥‡æ€ªï¼Œå› ä¸ºå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚ **

### (2)ä¼˜åŒ–æ–¹æ³• æ¢¯åº¦ä¸‹é™

![image.png](https://gitee.com/zhang-junjie123/picture/raw/master/image/20250129200034.png)
è®­ç»ƒWord2vecæ¨¡å‹æ—¶ä¼˜åŒ–å‚æ•°ä»¥æœ€å°åŒ–æŸå¤±çš„ç›¸å…³å†…å®¹ï¼š 
- **è®­ç»ƒæ¨¡å‹çš„æ–¹æ³•**ï¼šä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œéœ€è¦é€æ¸è°ƒæ•´å‚æ•°ä»¥æœ€å°åŒ–æŸå¤±ã€‚ 
- **å‚æ•°è¡¨ç¤º**ï¼š$\theta$è¡¨ç¤ºæ‰€æœ‰çš„æ¨¡å‹å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªé•¿å‘é‡ã€‚åœ¨è¯å‘é‡ç»´åº¦ä¸º$d$ï¼Œè¯æ±‡é‡ä¸º$V$çš„æƒ…å†µä¸‹ï¼Œç”±äºæ¯ä¸ªè¯æœ‰ä¸¤ä¸ªå‘é‡ï¼ˆä¸­å¿ƒè¯å‘é‡å’Œä¸Šä¸‹æ–‡è¯å‘é‡ï¼‰ï¼Œæ‰€ä»¥$\theta \in \mathbb{R}^{2d*V}$ï¼Œä¾‹å¦‚å‘é‡ä¸­åŒ…å«â€œaardvarkâ€ï¼ˆåœŸè±šï¼‰ã€â€œaâ€ã€â€œzebraâ€ï¼ˆæ–‘é©¬ï¼‰ç­‰è¯å¯¹åº”çš„ä¸­å¿ƒè¯å‘é‡$v$å’Œä¸Šä¸‹æ–‡è¯å‘é‡$u$ ã€‚
- **ä¼˜åŒ–æ–¹å¼**ï¼šé€šè¿‡**æ¢¯åº¦ä¸‹é™æ³•æ¥ä¼˜åŒ–è¿™äº›å‚æ•°ï¼ˆå¦‚å³ä¾§å›¾ç¤ºæ‰€ç¤ºï¼‰**ï¼Œå¹¶ä¸”éœ€è¦è®¡ç®—æ‰€æœ‰å‘é‡çš„æ¢¯åº¦ã€‚ æ€»ç»“æ¥è¯´ï¼Œå›¾ç‰‡è¯´æ˜äº†åœ¨Word2vecæ¨¡å‹è®­ç»ƒä¸­å‚æ•°çš„è¡¨ç¤ºå½¢å¼ä»¥åŠä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å‚æ•°æ¥æœ€å°åŒ–æŸå¤±çš„è¿‡ç¨‹ã€‚
![Capture_20250129_210440.jpg|699](https://gitee.com/zhang-junjie123/picture/raw/master/image/Capture_20250129_210440.jpg)


